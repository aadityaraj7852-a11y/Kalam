<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8">

<title>MCQ Book PDF Tool</title>

<!-- fonts -->
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;600&display=swap" rel="stylesheet">

<!-- libs -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>

body{
  font-family:'Noto Sans Devanagari';
  background:#f3f6fb;
  margin:15px;
}

.wrap{display:flex;gap:15px}

.panel{
  background:#fff;
  padding:12px;
  border-radius:10px;
  box-shadow:0 0 5px rgba(0,0,0,0.1);
}

.left{flex:1}
.right{flex:1.2}

input,textarea{
  width:100%;
  padding:7px;
  margin:5px 0;
  border-radius:6px;
  border:1px solid #ccc;
}

button{
  padding:7px 12px;
  border:none;
  border-radius:6px;
  cursor:pointer;
  margin:3px;
}

.green{background:#10b981;color:#fff}
.blue{background:#0b74ff;color:#fff}
.orange{background:#f59e0b;color:#fff}


/* ===== BOOK PAGE ===== */

.page{
  width:794px;
  height:1123px;
  background:#fff;
  margin:20px auto;
  padding:80px 70px;
  position:relative;

  display:grid;
  grid-template-columns:1fr 1fr;
  gap:25px;
}

/* vertical divider */
.page:before{
  content:"";
  position:absolute;
  top:70px;
  bottom:70px;
  left:50%;
  width:2px;
  background:#bbb;
}

/* header/footer */
.header{
  position:absolute;
  top:20px;
  left:0;right:0;
  text-align:center;
  font-weight:bold;
}

.footer{
  position:absolute;
  bottom:20px;
  left:0;right:0;
  text-align:center;
  font-size:13px;
}

.qbox{
  font-size:14px;
  line-height:1.5;
  white-space:pre-wrap;
}

.exp{
  border:1.8px solid #000;
  border-radius:10px;
  padding:4px;
  margin:4px 0;
}

</style>
</head>

<body>

<h2>MCQ Book Generator</h2>

<div class="wrap">

<div class="panel left">

<textarea id="q" placeholder="Question"></textarea>
<input id="a" placeholder="Option A">
<input id="b" placeholder="Option B">
<input id="c" placeholder="Option C">
<input id="d" placeholder="Option D">
<input id="ans" placeholder="Answer (A/B/C/D)">
<textarea id="exp" placeholder="Explanation"></textarea>

<button class="green" onclick="add()">Add</button>
<button class="orange" onclick="translateAll()">Translate</button>
<button class="blue" onclick="generatePDF()">Generate PDF</button>

<label>JSON Import</label>
<textarea id="jsonArea"></textarea>
<button onclick="importJSON()">Import JSON</button>

</div>


<div class="panel right">
<h3>Preview</h3>
<div id="preview"></div>
</div>

</div>


<script>

const { jsPDF } = window.jspdf;
let DATA=[];


/* ADD */
function add(){
  DATA.push({
    question:q.value,
    options:[a.value,b.value,c.value,d.value],
    answer:ans.value,
    exp:exp.value,
    eng:{}
  });

  q.value=a.value=b.value=c.value=d.value=ans.value=exp.value="";
  render();
}


/* IMPORT */
function importJSON(){
  DATA=JSON.parse(jsonArea.value);
  render();
}


/* TRANSLATE */
async function tr(t){
  const r=await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=hi&tl=en&dt=t&q=${encodeURIComponent(t)}`);
  const d=await r.json();
  return d[0].map(x=>x[0]).join("");
}

async function translateAll(){
  for(let item of DATA){
    item.eng.question=await tr(item.question);
  }
  render();
}


/* RENDER BOOK */
function render(){

  preview.innerHTML="";
  let page=createPage(1);
  preview.appendChild(page);

  let count=0,pageNo=1;

  DATA.forEach((item,i)=>{

    if(count==8){
      page=createPage(++pageNo);
      preview.appendChild(page);
      count=0;
    }

    const div=document.createElement("div");
    div.className="qbox";

    div.innerHTML=
`Q${i+1}. ${item.question}

A. ${item.options[0]}
B. ${item.options[1]}
C. ${item.options[2]}
D. ${item.options[3]}

<div class="exp">Explanation: ${item.exp}</div>
Answer: ${item.answer}

${item.eng.question ? "<i>"+item.eng.question+"</i>" : ""}`;

    page.appendChild(div);
    count++;
  });
}


function createPage(no){

  const p=document.createElement("div");
  p.className="page";

  const h=document.createElement("div");
  h.className="header";
  h.innerText="MCQ Practice Book";

  const f=document.createElement("div");
  f.className="footer";
  f.innerText="Page "+no;

  p.appendChild(h);
  p.appendChild(f);

  return p;
}


/* PDF */
async function generatePDF(){

  const pages=document.querySelectorAll(".page");
  const pdf=new jsPDF('p','px',[794,1123]);

  for(let i=0;i<pages.length;i++){

    const canvas=await html2canvas(pages[i],{scale:2});
    const img=canvas.toDataURL("image/png");

    if(i>0) pdf.addPage();
    pdf.addImage(img,'PNG',0,0,794,1123);
  }

  pdf.save("MCQ_Book.pdf");
}

</script>
</body>
</html>
